import"core-js/features/promise";function e(){return(e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}window.CustomEvent||function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var a=document.createEvent("CustomEvent");return a.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),a}e.prototype=window.Event.prototype,window.CustomEvent=e}();var t=["VKWebAppGetAuthToken","VKWebAppCallAPIMethod","VKWebAppAddToCommunity","VKWebAppGetGeodata","VKWebAppGetUserInfo","VKWebAppGetPhoneNumber","VKWebAppGetClientVersion","VKWebAppGetCommunityAuthToken","VKWebAppOpenPayForm","VKWebAppShare","VKWebAppAllowNotifications","VKWebAppDenyNotifications","VKWebAppShowWallPostBox","VKWebAppGetEmail","VKWebAppAllowMessagesFromGroup","VKWebAppJoinGroup","VKWebAppOpenApp","VKWebAppSetViewSettings","VKWebAppSetLocation","VKWebAppScroll","VKWebAppResizeWindow"],a="undefined"!=typeof window,n=navigator&&~navigator.userAgent.indexOf("CriOS"),o=a&&window.AndroidBridge,i=!n&&(a&&window.webkit&&window.webkit.messageHandlers),r=!o&&!i,p=r?"message":"VKWebAppEvent",d={},s=0,u="",l=[];window.addEventListener(p,function(t){var a=null,n={};if(r){if(t.data.type&&"VKWebAppSettings"===t.data.type)return void(u=t.data.frameId);t.data.hasOwnProperty("frameId")&&delete t.data.frameId,t.data.hasOwnProperty("connectVersion")&&delete t.data.connectVersion}if(l.length>0&&c(t),r?t.data&&t.data.data&&(n=e({},t.data),a=d[n.data.request_id]):t.detail&&t.detail.data&&(n=e({},t.detail),a=d[n.data.request_id]),n.data&&n.data.request_id&&(a=d[n.data.request_id]))return a.customRequestId&&delete n.data.request_id,n.data.error_type?a.reject(n):a.resolve(n)});var c=function(t){var a=l.slice(),n={};r?n.detail=e({},t.data):t.detail&&t.detail.data&&(n.detail=e({},t.detail)),a.forEach(function(e){e(n)})},f={send:function(e,t){t||(t={});var a=t.request_id?t.request_id:"method#"+s++,n=!1;if(t.hasOwnProperty("request_id")||(n=!0,t.request_id=a),o&&"function"==typeof o[e]&&o[e](JSON.stringify(t)),i&&i[e]&&"function"==typeof i[e].postMessage&&i[e].postMessage(t),r&&parent.postMessage({handler:e,params:t,frameId:u,type:"vk-connect"},"*"),"VKWebAppInit"!==e)return new Promise(function(e,o){d[a]={resolve:e,reject:o,params:t,customRequestId:n}})},supports:function(e){return!(!o||"function"!=typeof o[e])||!(!i||!i[e]||"function"!=typeof i[e].postMessage)||!!~t.indexOf(e)},subscribe:function(e){l.push(e)}};export default f;
